<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>「千载弦歌，芳华如梦」 - sczyh30&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <!--<meta name="keywords" content="sczyh30, blog"/>-->
  <meta name="description" content="sczyh30&apos;s blog">
<meta property="og:type" content="website">
<meta property="og:title" content="「千载弦歌，芳华如梦」 - sczyh30's blog">
<meta property="og:url" content="http://www.sczyh30.com/page/6/index.html">
<meta property="og:site_name" content="「千载弦歌，芳华如梦」 - sczyh30's blog">
<meta property="og:description" content="sczyh30&apos;s blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="「千载弦歌，芳华如梦」 - sczyh30's blog">
<meta name="twitter:description" content="sczyh30&apos;s blog">
  
    <link rel="alternative" href="/atom.xml" title="「千载弦歌，芳华如梦」 - sczyh30&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" type="text/css">
  
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: true
      }
  </script>
  
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="http://7xkkgd.com1.z0.glb.clouddn.com/blog_default_avatar.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/">sczyh30</a></h1>
        </hgroup>

        
        <p class="header-subtitle">踏歌长行，梦想永在。</p>
        
                


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                            <li><a href="/about">About Me</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:sczyh16@gmail.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/sczyh30" title="GitHub"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="/#" title="新浪微博"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                                <li id="Google"><a class="Google" target="_blank" href="https://plus.google.com/u/0/117807083506391735472" title="Google"></a></li>
                            
                                <li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/sczyh30" title="Twitter"></a></li>
                            
                                <li id="Medium"><a class="Medium" target="_blank" href="https://medium.com/@sczyh30" title="Medium"></a></li>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/AIO/" style="font-size: 10px;">AIO</a> <a href="/tags/AMQP/" style="font-size: 10px;">AMQP</a> <a href="/tags/Algorithm/" style="font-size: 13.75px;">Algorithm</a> <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/C/" style="font-size: 10px;">C</a> <a href="/tags/C/" style="font-size: 17.5px;">C++</a> <a href="/tags/C-11/" style="font-size: 10px;">C++ 11</a> <a href="/tags/CE3/" style="font-size: 10px;">CE3</a> <a href="/tags/Cache/" style="font-size: 10px;">Cache</a> <a href="/tags/Chemistry/" style="font-size: 11.25px;">Chemistry</a> <a href="/tags/Compiler/" style="font-size: 10px;">Compiler</a> <a href="/tags/Database/" style="font-size: 11.25px;">Database</a> <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Engine/" style="font-size: 10px;">Engine</a> <a href="/tags/FRP/" style="font-size: 10px;">FRP</a> <a href="/tags/Functional-Programming/" style="font-size: 11.25px;">Functional Programming</a> <a href="/tags/G1/" style="font-size: 10px;">G1</a> <a href="/tags/GC/" style="font-size: 13.75px;">GC</a> <a href="/tags/GDB/" style="font-size: 10px;">GDB</a> <a href="/tags/Game/" style="font-size: 11.25px;">Game</a> <a href="/tags/HashMap/" style="font-size: 11.25px;">HashMap</a> <a href="/tags/Haskell/" style="font-size: 10px;">Haskell</a> <a href="/tags/HotSpot/" style="font-size: 11.25px;">HotSpot</a> <a href="/tags/IO/" style="font-size: 10px;">IO</a> <a href="/tags/JUC/" style="font-size: 10px;">JUC</a> <a href="/tags/JVM/" style="font-size: 18.75px;">JVM</a> <a href="/tags/Java/" style="font-size: 20px;">Java</a> <a href="/tags/Klass-oop/" style="font-size: 10px;">Klass-oop</a> <a href="/tags/LinkedList/" style="font-size: 10px;">LinkedList</a> <a href="/tags/Linux/" style="font-size: 11.25px;">Linux</a> <a href="/tags/Mathematical-Logic/" style="font-size: 10px;">Mathematical Logic</a> <a href="/tags/Metaspace/" style="font-size: 10px;">Metaspace</a> <a href="/tags/Network/" style="font-size: 16.25px;">Network</a> <a href="/tags/OS/" style="font-size: 10px;">OS</a> <a href="/tags/Object-Model/" style="font-size: 13.75px;">Object Model</a> <a href="/tags/RabbitMQ/" style="font-size: 10px;">RabbitMQ</a> <a href="/tags/Reflection/" style="font-size: 11.25px;">Reflection</a> <a href="/tags/SQL/" style="font-size: 10px;">SQL</a> <a href="/tags/STL/" style="font-size: 11.25px;">STL</a> <a href="/tags/Scala/" style="font-size: 11.25px;">Scala</a> <a href="/tags/Sort/" style="font-size: 10px;">Sort</a> <a href="/tags/Struct/" style="font-size: 10px;">Struct</a> <a href="/tags/Summary/" style="font-size: 13.75px;">Summary</a> <a href="/tags/TCP/" style="font-size: 15px;">TCP</a> <a href="/tags/UE4/" style="font-size: 10px;">UE4</a> <a href="/tags/Unity/" style="font-size: 10px;">Unity</a> <a href="/tags/View/" style="font-size: 10px;">View</a> <a href="/tags/Web/" style="font-size: 12.5px;">Web</a> <a href="/tags/event/" style="font-size: 10px;">event</a> <a href="/tags/functional/" style="font-size: 10px;">functional</a> <a href="/tags/中间件/" style="font-size: 10px;">中间件</a> <a href="/tags/事务/" style="font-size: 10px;">事务</a> <a href="/tags/内存区域/" style="font-size: 10px;">内存区域</a> <a href="/tags/前端/" style="font-size: 12.5px;">前端</a> <a href="/tags/基础/" style="font-size: 10px;">基础</a> <a href="/tags/多线程/" style="font-size: 10px;">多线程</a> <a href="/tags/并发/" style="font-size: 11.25px;">并发</a> <a href="/tags/开发/" style="font-size: 17.5px;">开发</a> <a href="/tags/异步/" style="font-size: 11.25px;">异步</a> <a href="/tags/性能/" style="font-size: 10px;">性能</a> <a href="/tags/性能优化/" style="font-size: 10px;">性能优化</a> <a href="/tags/操作系统/" style="font-size: 10px;">操作系统</a> <a href="/tags/数据库/" style="font-size: 11.25px;">数据库</a> <a href="/tags/架构/" style="font-size: 11.25px;">架构</a> <a href="/tags/线程安全/" style="font-size: 10px;">线程安全</a> <a href="/tags/编译原理/" style="font-size: 10px;">编译原理</a> <a href="/tags/虚拟化/" style="font-size: 10px;">虚拟化</a>
                    </div>
                </section>
                
                
                

                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">Fighting</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">sczyh30</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="http://7xkkgd.com1.z0.glb.clouddn.com/blog_default_avatar.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">sczyh30</a></h1>
            </hgroup>
            
            <p class="header-subtitle">踏歌长行，梦想永在。</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                    <li><a href="/about">About Me</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <li id="Email"><a class="Email" target="_blank" href="mailto:sczyh16@gmail.com" title="Email"></a></li>
                            
                                <li id="GitHub"><a class="GitHub" target="_blank" href="https://github.com/sczyh30" title="GitHub"></a></li>
                            
                                <li id="新浪微博"><a class="新浪微博" target="_blank" href="/#" title="新浪微博"></a></li>
                            
                                <li id="RSS"><a class="RSS" target="_blank" href="/atom.xml" title="RSS"></a></li>
                            
                                <li id="Google"><a class="Google" target="_blank" href="https://plus.google.com/u/0/117807083506391735472" title="Google"></a></li>
                            
                                <li id="Twitter"><a class="Twitter" target="_blank" href="https://twitter.com/sczyh30" title="Twitter"></a></li>
                            
                                <li id="Medium"><a class="Medium" target="_blank" href="https://medium.com/@sczyh30" title="Medium"></a></li>
                            
                        </ul>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-jvm-memory" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/posts/Java/jvm-memory/" class="article-date">
      <time datetime="2015-06-23T16:00:00.000Z" itemprop="datePublished">2015-06-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/Java/jvm-memory/">深入探究JVM | Java的内存区域解析</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Java 虚拟机在执行Java程序的时候会把它管理的内存区域划为几部分，这一节我们就来解析一下Java的内存区域。</p>
<hr>
<p>有的人把JVM管理的内存简单地分为堆内存和栈内存，这样分未免有些太肤浅了。<br>Java的内存区域主要分为五部分：</p>
<ul>
<li>程序计数器(PC)</li>
<li>虚拟机栈(JVM Stack)</li>
<li>本地方法栈(Native Method Stack)</li>
<li>Java 堆内存(Java Heap)</li>
<li>方法区(Method Area)</li>
</ul>
<p><img src="http://img.blog.csdn.net/20150626182021585" alt="Java内存区域"><br>（图转自网络）</p>
<p>下面我们来解析这几个区域。</p>
<h2 id="程序计数器">程序计数器</h2><p>相信学过计算机组成原理的人都知道，CPU内部的寄存器中就包含一个程序计数器（x86下为eip寄存器,ARM下为R15寄存器），存放程序执行的下一条指令地址。在程序开始执行前，将程序指令序列的起始地址，即程序的第一条指令所在的内存单元地址送入PC，CPU按照PC的地址从内存中读取第一条指令。每一条指令执行时，CPU会自动修改PC的量至下一条指令的地址，指令之间的跳转离不开PC。JVM内存中的程序计数器也是这样的作用，它储存JVM当前执行bytecode的地址。</p>
<p>Java虚拟机允许多个线程同时执行指令。如果有多个线程正在执行指令，那么每个线程都会有一个程序计数器，它是线程私有的。在任意时刻，一个线程只允许执行一个方法的代码。每当执行到一条Java方法的指令时，程序计数器保存当前执行字节码的地址；若执行的为native方法，则PC的值为undefined。</p>
<h2 id="Java_虚拟机栈">Java 虚拟机栈</h2><p>Java虚拟机栈也是线程私有的，每一条线程都拥有自己私有的Java 虚拟机栈，它与线程同时创建。它描述了Java方法执行的内存模型：每个方法在执行的同时都会创建一个<strong>栈帧</strong>，用于存储<strong>局部变量表、操作数栈、动态链接、方法出口</strong>等信息。每一个方法从调用直至完成的过程，都对应一个栈帧从入栈到出栈的过程。关于栈帧详细的内容在后边复习虚拟机字节码执行引擎的时候再说吧。<br>Java 虚拟机栈在方法调用和返回中也扮演了很重要的角色。因为除了栈帧的入栈和出栈之外，Java虚拟机栈不会再受其它因素的影响，因此栈帧可在<strong>系统的堆</strong>上分配内存（<strong>注意</strong>，是系统的Heap而不是Java Heap）。Java虚拟机栈所使用的内存不需要保证是连续的。</p>
<h2 id="本地方法栈">本地方法栈</h2><p>本地方法栈和Java虚拟机栈的作用相似，Java虚拟机栈执行的是字节码，而本地方法栈执行的是native方法。本地方法栈使用<strong>传统的栈</strong>（C Stack）来支持native方法。在HotSpot JVM中Java虚拟机栈和本地方法栈合二为一。</p>
<h2 id="Java_堆">Java 堆</h2><p>在JVM中，Java 堆是可供各线程共享的运行时内存区域，是Java 虚拟机所管理的内存区域中最大的一块。此区域非常重要，<strong>几乎所有的对象实例和数组实例都要在Java堆上分配</strong>，但随着JIT编译器及逃逸分析技术的发展，也可能会被优化为栈上分配，高大上。。。）。同时，Java 堆也是发生GC收集的主要区域。<br>从内存回收的角度来看，它可以分为<strong>新生代</strong>和<strong>老年代</strong>，再细分可以分为Eden Space,From Survivor Space,To Survivor Space区域。Java堆的容量可以是固定的，也可以随着需要来扩展，并且在用不到的时候自动收缩。</p>
<h2 id="方法区">方法区</h2><p>方法区是线程共享的，它储存了<strong>每一个类的结构信息</strong>，比如运行时常量池（runtime constant pool）、字段和方法数据、构造函数和普通方法的字节码内容，还包括一些初始化的时候用到的特殊方法。<strong>方法区是堆的逻辑部分。</strong><br>在JDK1.7及以前的HotSpot JVM中，方法区位于<em>永久代</em>（Permanent Generation，<em>PermGen</em>）中。由于永久代内可能会发生内存泄露或溢出等问题而导致的<em>java.lang.OutOfMemoryError: PermGen </em>，JEP小组从JDK1.7开始就筹划移除永久代（<a href="http://openjdk.java.net/jeps/122" target="_blank" rel="external">JEP 122: Remove the Permanent Generation</a>），并且在JDK 1.7中把字符串常量，符号引用等移出了永久代。到了Java 8，永久代被彻底地移出了JVM，取而代之的是<em>元空间</em>（Metaspace）：</p>
<blockquote>
<p>In JDK 8, classes metadata is now stored in the native heap and this space is called Metaspace.</p>
</blockquote>
<p>所以从Java 8开始，方法区被移至 <em>Metaspace</em> 内。有关Metaspace的相关总结，见下一篇文章。</p>
<h2 id="运行时常量池">运行时常量池</h2><p>运行时常量池是class文件中每一个类或接口的常量池表的运行时表示形式，是方法区的一部分。它包括了若干种不同的常量。常量池表存放<strong>编译器生成的各种字面量和符号引用</strong>，这部分内容将在类加载后进入方法区的运行时常量池中存放。运行时常量池具有动态性，运行期间也可以将新的量放到运行时常量池中，典型的应用是String类的intern方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> String <span class="title">intern</span><span class="params">()</span></span></span><br></pre></td></tr></table></figure></p>
<p>JDK 1.7开始，字符串常量和符号引用等就被移出永久代：</p>
<ul>
<li>符号引用迁移至系统堆内存(<em>Native Heap</em>)</li>
<li>字符串字面量迁移至Java堆(<em>Java Heap</em>)</li>
</ul>
<p><strong>下一篇文章我将会总结Java 8中的Metaspace相关知识</strong>。</p>
<hr>
<h1 id="参考资料">参考资料</h1><ul>
<li>《深入理解Java虚拟机：JVM高级特性与最佳实践》，周志明 著</li>
<li><a href="http://stackoverflow.com/questions/24074164/what-is-the-use-of-metaspace-in-java-8" target="_blank" rel="external">What is the use of Metaspace in Java 8? - StackOverflow</a></li>
<li><a href="https://blogs.oracle.com/poonam/entry/about_g1_garbage_collector_permanent" target="_blank" rel="external">About G1 Garbage Collector, Permanent Generation and Metaspace</a></li>
<li><em>The Java Virtual Machine Specification, Java SE 8 Edition, Oracle</em></li>
<li><a href="http://openjdk.java.net/jeps/122" target="_blank" rel="external">JEP 122: Remove the Permanent Generation</a></li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Java/">Java</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JVM/">JVM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/内存区域/">内存区域</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-java-reflection-1" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/posts/Java/java-reflection-1/" class="article-date">
      <time datetime="2015-06-23T16:00:00.000Z" itemprop="datePublished">2015-06-24</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/Java/java-reflection-1/">深入解析Java反射（1） - 基础</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>因为本人最近正筹备<a href="http://www.sczyh30.com/samsara">Samsara</a>框架的开发，而其中的IOC部分非常依靠反射，因此趁这个机会来总结一下关于Java反射的一些知识。本篇为基本篇，基于JDK 1.8。</p>
<hr>
<h2 id="一、回顾：什么是反射？">一、回顾：什么是反射？</h2><p>反射(Reflection)是Java 程序开发语言的特征之一，它允许运行中的 Java 程序获取自身的信息，并且可以操作类或对象的内部属性。<br>Oracle官方对反射的解释是</p>
<blockquote>
<p>Reflection enables Java code to discover information about the fields, methods and constructors of loaded classes, and to use reflected fields, methods, and constructors to operate on their underlying counterparts, within security restrictions.<br>The API accommodates applications that need access to either the public members of a target object (based on its runtime class) or the members declared by a given class. It also allows programs to suppress default reflective access control.</p>
</blockquote>
<p>&emsp;简而言之，通过反射，我们可以在运行时获得程序或程序集中每一个类型的成员和成员的信息。<br>程序中一般的对象的类型都是在编译期就确定下来的，而Java反射机制可以动态地创建对象并调用其属性，这样的对象的类型在编译期是未知的。所以我们可以通过反射机制直接创建对象，即使这个对象的类型在编译期是未知的。<br>&emsp;反射的核心是JVM在运行时才动态加载类或调用方法/访问属性，它不需要事先（写代码的时候或编译期）知道运行对象是谁。</p>
<p>Java反射框架主要提供以下功能：</p>
<ul>
<li>1.在运行时判断任意一个对象所属的类；</li>
<li>2.在运行时构造任意一个类的对象；</li>
<li>3.在运行时判断任意一个类所具有的成员变量和方法（通过反射甚至可以调用private方法）；</li>
<li>4.在运行时调用任意一个对象的方法<h5 id="重点：是运行时而不是编译时">重点：<strong>是运行时而不是编译时</strong></h5></li>
</ul>
<h2 id="二、反射的主要用途">二、反射的主要用途</h2><p>&emsp;很多人都认为反射在实际的Java开发应用中并不广泛，其实不然。<br>&emsp;当我们在使用IDE(如Eclipse，IDEA)时，当我们输入一个对象或类并想调用它的属性或方法时，一按点号，编译器就会自动列出它的属性或方法，这里就会用到反射。<br>&emsp;<strong>反射最重要的用途就是开发各种通用框架。</strong><br>&emsp;很多框架（比如Spring）都是配置化的（比如通过XML文件配置JavaBean,Action之类的），为了保证框架的通用性，它们可能需要根据配置文件加载不同的对象或类，调用不同的方法，这个时候就必须用到反射——运行时动态加载需要加载的对象。<br>&emsp;举一个例子，在运用Struts 2框架的开发中我们一般会在struts.xml里去配置Action，比如：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">action</span> <span class="attribute">name</span>=<span class="value">"login"</span></span><br><span class="line">               <span class="attribute">class</span>=<span class="value">"org.ScZyhSoft.test.action.SimpleLoginAction"</span></span><br><span class="line">               <span class="attribute">method</span>=<span class="value">"execute"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="title">result</span>&gt;</span>/shop/shop-index.jsp<span class="tag">&lt;/<span class="title">result</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="title">result</span> <span class="attribute">name</span>=<span class="value">"error"</span>&gt;</span>login.jsp<span class="tag">&lt;/<span class="title">result</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="title">action</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>配置文件与Action建立了一种映射关系，当View层发出请求时，请求会被StrutsPrepareAndExecuteFilter拦截，然后StrutsPrepareAndExecuteFilter会去动态地创建Action实例。<br>——比如我们请求login.action，那么StrutsPrepareAndExecuteFilter就会去解析struts.xml文件，检索action中name为login的Action，并根据class属性创建SimpleLoginAction实例，并用invoke方法来调用execute方法，这个过程离不开反射。<br>对与框架开发人员来说，反射虽小但作用非常大，它是各种容器实现的核心。而对于一般的开发者来说，不深入框架开发则用反射用的就会少一点，不过了解一下框架的底层机制有助于丰富自己的编程思想，也是很有益的。</p>
<h2 id="三、反射的基本运用">三、反射的基本运用</h2><p>上面我们提到了反射可以用于判断任意对象所属的类，获得Class对象，构造任意一个对象以及调用一个对象。这里我们介绍一下基本反射功能的实现(反射相关的类一般都在java.lang.relfect包里)。</p>
<h4 id="1、获得Class对象">1、获得Class对象</h4><p>方法有三种<br>(1)使用Class类的forName静态方法:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">public</span> <span class="keyword">static</span> Class&lt;?&gt; forName(String className)</span><br><span class="line">``` </span><br><span class="line">在JDBC开发中常用此方法加载数据库驱动:</span><br><span class="line">```java</span><br><span class="line"> Class.forName(driver);</span><br></pre></td></tr></table></figure></p>
<p>(2)直接获取某一个对象的class，比如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; klass = <span class="keyword">int</span>.class;</span><br><span class="line">Class&lt;?&gt; classInt = Integer.TYPE;</span><br></pre></td></tr></table></figure></p>
<p>(3)调用某个对象的getClass()方法,比如:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">StringBuilder str = <span class="keyword">new</span> StringBuilder(<span class="string">"123"</span>);</span><br><span class="line">Class&lt;?&gt; klass = str.getClass();</span><br></pre></td></tr></table></figure></p>
<h4 id="2、判断是否为某个类的实例">2、判断是否为某个类的实例</h4><p>一般地，我们用instanceof关键字来判断是否为某个类的实例。同时我们也可以借助反射中Class对象的isInstance()方法来判断是否为某个类的实例，它是一个Native方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">boolean</span> <span class="title">isInstance</span><span class="params">(Object obj)</span></span>;</span><br></pre></td></tr></table></figure></p>
<h4 id="3、创建实例">3、创建实例</h4><p>通过反射来生成对象主要有两种方式。<br>（1）使用Class对象的newInstance()方法来创建Class对象对应类的实例。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Class&lt;?&gt; c = String.class;</span><br><span class="line">Object str = c.newInstance();</span><br></pre></td></tr></table></figure></p>
<p>（2）先通过Class对象获取指定的Constructor对象，再调用Constructor对象的newInstance()方法来创建实例。这种方法可以用指定的构造器构造类的实例。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取String所对应的Class对象</span></span><br><span class="line">Class&lt;?&gt; c = String.class;</span><br><span class="line"><span class="comment">//获取String类带一个String参数的构造器</span></span><br><span class="line">Constructor constructor = c.getConstructor(String.class);</span><br><span class="line"><span class="comment">//根据构造器创建实例</span></span><br><span class="line">Object obj = constructor.newInstance(<span class="string">"23333"</span>);</span><br><span class="line">System.out.println(obj);</span><br></pre></td></tr></table></figure></p>
<h4 id="4、获取方法">4、获取方法</h4><p>获取某个Class对象的方法集合，主要有以下几个方法：<br>getDeclaredMethods()方法返回类或接口声明的所有方法，包括公共、保护、默认（包）访问和私有方法，但不包括继承的方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Method[] getDeclaredMethods() <span class="keyword">throws</span> SecurityException</span><br></pre></td></tr></table></figure></p>
<p>getMethods()方法返回某个类的所有公用（public）方法，包括其继承类的公用方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Method[] getMethods() <span class="keyword">throws</span> SecurityException</span><br></pre></td></tr></table></figure></p>
<p>getMethod方法返回一个特定的方法，其中第一个参数为方法名称，后面的参数为方法的参数对应Class的对象<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Method <span class="title">getMethod</span><span class="params">(String name, Class&lt;?&gt;... parameterTypes)</span></span></span><br></pre></td></tr></table></figure></p>
<p>只是这样描述的话可能难以理解，我们用例子来理解这三个方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.ScZyhSoft.common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test1</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException </span>&#123;</span><br><span class="line">	        Class&lt;?&gt; c = methodClass.class;</span><br><span class="line">	        Object object = c.newInstance();</span><br><span class="line">	        Method[] methods = c.getMethods();</span><br><span class="line">	        Method[] declaredMethods = c.getDeclaredMethods();</span><br><span class="line">	        <span class="comment">//获取methodClass类的add方法</span></span><br><span class="line">	        Method method = c.getMethod(<span class="string">"add"</span>, <span class="keyword">int</span>.class, <span class="keyword">int</span>.class);</span><br><span class="line">	        <span class="comment">//getMethods()方法获取的所有方法</span></span><br><span class="line">	        System.out.println(<span class="string">"getMethods获取的方法："</span>);</span><br><span class="line">	        <span class="keyword">for</span>(Method m:methods)</span><br><span class="line">	            System.out.println(m);</span><br><span class="line">	        <span class="comment">//getDeclaredMethods()方法获取的所有方法</span></span><br><span class="line">	        System.out.println(<span class="string">"getDeclaredMethods获取的方法："</span>);</span><br><span class="line">	        <span class="keyword">for</span>(Method m:declaredMethods)</span><br><span class="line">	            System.out.println(m);</span><br><span class="line">	    &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">methodClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> fuck = <span class="number">3</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>程序运行的结果如下:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">getMethods获取的方法：</span><br><span class="line">public int org<span class="class">.ScZyhSoft</span><span class="class">.common</span><span class="class">.methodClass</span><span class="class">.add</span>(int,int)</span><br><span class="line">public int org<span class="class">.ScZyhSoft</span><span class="class">.common</span><span class="class">.methodClass</span><span class="class">.sub</span>(int,int)</span><br><span class="line">public final void java<span class="class">.lang</span><span class="class">.Object</span><span class="class">.wait</span>() throws java<span class="class">.lang</span><span class="class">.InterruptedException</span></span><br><span class="line">public final void java<span class="class">.lang</span><span class="class">.Object</span><span class="class">.wait</span>(long,int) throws java<span class="class">.lang</span><span class="class">.InterruptedException</span></span><br><span class="line">public final native void java<span class="class">.lang</span><span class="class">.Object</span><span class="class">.wait</span>(long) throws java<span class="class">.lang</span><span class="class">.InterruptedException</span></span><br><span class="line">public boolean java<span class="class">.lang</span><span class="class">.Object</span><span class="class">.equals</span>(java<span class="class">.lang</span><span class="class">.Object</span>)</span><br><span class="line">public java<span class="class">.lang</span><span class="class">.String</span> java<span class="class">.lang</span><span class="class">.Object</span><span class="class">.toString</span>()</span><br><span class="line">public native int java<span class="class">.lang</span><span class="class">.Object</span><span class="class">.hashCode</span>()</span><br><span class="line">public final native java<span class="class">.lang</span><span class="class">.Class</span> java<span class="class">.lang</span><span class="class">.Object</span><span class="class">.getClass</span>()</span><br><span class="line">public final native void java<span class="class">.lang</span><span class="class">.Object</span><span class="class">.notify</span>()</span><br><span class="line">public final native void java<span class="class">.lang</span><span class="class">.Object</span><span class="class">.notifyAll</span>()</span><br><span class="line">getDeclaredMethods获取的方法：</span><br><span class="line">public int org<span class="class">.ScZyhSoft</span><span class="class">.common</span><span class="class">.methodClass</span><span class="class">.add</span>(int,int)</span><br><span class="line">public int org<span class="class">.ScZyhSoft</span><span class="class">.common</span><span class="class">.methodClass</span><span class="class">.sub</span>(int,int)</span><br></pre></td></tr></table></figure></p>
<p>可以看到，通过getMethods()获取的方法可以获取到父类的方法,比如java.lang.Object下定义的各个方法。</p>
<h4 id="5、获取构造器信息">5、获取构造器信息</h4><p>获取类构造器的用法与上述获取方法的用法类似。主要是通过Class类的getConstructor方法得到Constructor类的一个实例，而Constructor类有一个newInstance方法可以创建一个对象实例:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> T <span class="title">newInstance</span><span class="params">(Object ... initargs)</span></span></span><br></pre></td></tr></table></figure></p>
<p>此方法可以根据传入的参数来调用对应的Constructor创建对象实例~</p>
<h4 id="6、获取类的成员变量（字段）信息">6、获取类的成员变量（字段）信息</h4><p>主要是这几个方法，在此不再赘述：<br><em>getFiled</em>: 访问公有的成员变量<br><em>getDeclaredField</em>：所有已声明的成员变量。但不能得到其父类的成员变量<br>getFileds和getDeclaredFields用法同上（参照Method）</p>
<h4 id="7、调用方法">7、调用方法</h4><p>当我们从类中获取了一个方法后，我们就可以用invoke()方法来调用这个方法。invoke方法的原型为:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object obj, Object... args)</span></span><br><span class="line">        <span class="keyword">throws</span> IllegalAccessException, IllegalArgumentException,</span><br><span class="line">           InvocationTargetException</span></span><br></pre></td></tr></table></figure></p>
<p>下面是一个实例：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException </span>&#123;</span><br><span class="line">        Class&lt;?&gt; klass = methodClass.class;</span><br><span class="line">        <span class="comment">//创建methodClass的实例</span></span><br><span class="line">        Object obj = klass.newInstance();</span><br><span class="line">        <span class="comment">//获取methodClass类的add方法</span></span><br><span class="line">        Method method = klass.getMethod(<span class="string">"add"</span>,<span class="keyword">int</span>.class,<span class="keyword">int</span>.class);</span><br><span class="line">        <span class="comment">//调用method对应的方法 =&gt; add(1,4)</span></span><br><span class="line">        Object result = method.invoke(obj,<span class="number">1</span>,<span class="number">4</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">methodClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> fuck = <span class="number">3</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">sub</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>关于invoke()方法的详解，后面我会专门写一篇文章来深入解析invoke的过程。</p>
<h4 id="8、利用反射创建数组">8、利用反射创建数组</h4><p>数组在Java里是比较特殊的一种类型，它可以赋值给一个Object Reference。下面我们看一看利用反射创建数组的例子：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">testArray</span><span class="params">()</span> <span class="keyword">throws</span> ClassNotFoundException </span>&#123;</span><br><span class="line">        Class&lt;?&gt; cls = Class.forName(<span class="string">"java.lang.String"</span>);</span><br><span class="line">        Object array = Array.newInstance(cls,<span class="number">25</span>);</span><br><span class="line">        <span class="comment">//往数组里添加内容</span></span><br><span class="line">        Array.set(array,<span class="number">0</span>,<span class="string">"hello"</span>);</span><br><span class="line">        Array.set(array,<span class="number">1</span>,<span class="string">"Java"</span>);</span><br><span class="line">        Array.set(array,<span class="number">2</span>,<span class="string">"fuck"</span>);</span><br><span class="line">        Array.set(array,<span class="number">3</span>,<span class="string">"Scala"</span>);</span><br><span class="line">        Array.set(array,<span class="number">4</span>,<span class="string">"Clojure"</span>);</span><br><span class="line">        <span class="comment">//获取某一项的内容</span></span><br><span class="line">        System.out.println(Array.get(array,<span class="number">3</span>));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>其中的Array类为java.lang.reflect.Array类。我们通过Array.newInstance()创建数组对象，它的原型是:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">newInstance</span><span class="params">(Class&lt;?&gt; componentType, <span class="keyword">int</span> length)</span></span><br><span class="line">        <span class="keyword">throws</span> NegativeArraySizeException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> newArray(componentType, length);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>而newArray()方法是一个Native方法，它在Hotspot JVM里的具体实现我们后边再研究，这里先把源码贴出来<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> Object <span class="title">newArray</span><span class="params">(Class&lt;?&gt; componentType, <span class="keyword">int</span> length)</span></span><br><span class="line">        <span class="keyword">throws</span> NegativeArraySizeException</span>;</span><br></pre></td></tr></table></figure></p>
<p>源码目录:openjdk\hotspot\src\share\vm\runtime\reflection.cpp<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">arrayOop Reflection::reflect_new_array(oop element_mirror, jint length, TRAPS) &#123;</span><br><span class="line">  <span class="keyword">if</span> (element_mirror == NULL) &#123;</span><br><span class="line">    THROW_0(vmSymbols::java_lang_NullPointerException());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (length &lt; <span class="number">0</span>) &#123;</span><br><span class="line">    THROW_0(vmSymbols::java_lang_NegativeArraySizeException());</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (java_lang_Class::is_primitive(element_mirror)) &#123;</span><br><span class="line">    Klass* tak = <span class="keyword">basic_type_mirror_t</span>o_arrayklass(element_mirror, CHECK_NULL);</span><br><span class="line">    <span class="keyword">return</span> TypeArrayKlass::cast(tak)-&gt;allocate(length, THREAD);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    Klass* k = java_lang_Class::as_Klass(element_mirror);</span><br><span class="line">    <span class="keyword">if</span> (k-&gt;oop_is_array() &amp;&amp; ArrayKlass::cast(k)-&gt;dimension() &gt;= MAX_DIM) &#123;</span><br><span class="line">      THROW_0(vmSymbols::java_lang_IllegalArgumentException());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> oopFactory::new_objArray(k, length, THREAD);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>另外，Array类的set()和get()方法都为Native方法，在HotSpot JVM里分别对应Reflection::array_set和Reflection::array_get方法，这里就不详细解析了。</p>
<h2 id="四、反射的一些注意事项（待补充）">四、反射的一些注意事项（待补充）</h2><p>由于反射会额外消耗一定的系统资源，因此如果不需要动态地创建一个对象，那么就不需要用反射。<br>另外，反射调用方法时可以忽略权限检查，因此可能会破坏封装性而导致安全问题。<br><img src="http://img.my.csdn.net/uploads/201508/02/1438529905_8952.jpg" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Java/">Java</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Reflection/">Reflection</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-docker-tutorial" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/posts/Architecture/docker-tutorial/" class="article-date">
      <time datetime="2015-06-08T16:12:36.000Z" itemprop="datePublished">2015-06-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/Architecture/docker-tutorial/">Docker入门学习札记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>很早之前就听说过Docker，但一直木有实践过。前一阵子参加开源中国的源创会时，里面嘉宾讲的东西提到了Docker，感觉Docker是一个很有意义的工具，于是就学习了一下它的基本用法，在此总结一下。<br>以我的理解，Docker是一种虚拟化容器，这个容器里可以运行各种程序，是一种轻量级的虚拟化技术，使用Golang编写。它与传统的虚拟化技术（KVM和Xen）的区别是，Docker容器是操作系统层面上的虚拟化（内核级），基于LXC技术，直接服用本地操作系统，而传统的虚拟化技术则是从硬件方面进行虚拟化。它的好处是，启动特别快，而且对系统资源的利用率较高，一台机器上可以运行很多Docker容器，而且因为Docker非常轻量，它为快速部署提供了很好的技术支持。并且Docker引入了版本控制的思想，可以更好地持续构建和部署。<br>下面总结一下Docker的基本用法：</p>
<h2 id="安装">安装</h2><p>用apt-get或者yum安装都是坑，基本上都不是最新版本的。要安装还是用官方的命令安装：<br><code>curl -sSL <a href="https://get.docker.com/" target="_blank" rel="external">https://get.docker.com/</a> | sh</code><br>不过由于Docker的安装文件存放在Amazon S3上，会间接性抽风，因此最好找个国内的源。<br>（2015-7 补充：DaoCloud是不错的选择，服务很好）</p>
<h2 id="容器与镜像">容器与镜像</h2><p>Docker容器可以理解为运行在沙盒里的进程。<br>通俗地讲，镜像（images）相当于一个类，而容器（container）相当于类的一个实例。容器可以不断地被修改，并通过commit化为一个镜像。</p>
<h2 id="基本命令">基本命令</h2><p>主要有：</p>
<h4 id="Docker信息">Docker信息</h4><p>查看Docker版本：<code>docker version</code><br>登录至远程库：<code>docker login</code></p>
<h4 id="镜像操作">镜像操作</h4><p>列出镜像列表：<code>docker images</code><br>删除镜像：<code>docker rmi [id]</code><br>搜索镜像：<code>docker search [name]</code><br>从远程拉取镜像：<code><strong>docker pull [name]:[tag]</strong></code><br>将镜像发布至远程：<code><strong>docker push [name]</strong></code></p>
<h4 id="容器运行"><strong>容器运行</strong></h4><p>容器运行用<code><strong>docker run</strong></code>命令，它有一些详细的参数很有用，比如：<br>以交互模式启动容器centos:latest : <code>docker run -i - t centos:latest /bin/bash</code><br><code>-i</code>表示支持输入，<code>-t</code>表示命令行交互。<br>以后台模式运行，并进行端口映射: <code>docker run -d -p 8080:8080 sczyh30/tomcat:v1 /start.sh</code><br><code>-d</code>表示daemon，即以后台方式运行。<code>-p</code>表示端口映射。<br>这里用的时候有个比较fucking的地方，如果运行容器的时候相应的命令不阻塞，那么容器会自动结束运行（比如resin）。看来以后运行命令要加个阻塞的命令咯~<br>另外对于在容器里自动执行apt-get命令时，一定要加上-y，否则容器虽然进入交互模式但却无法响应，运行完即退出。</p>
<h4 id="容器管理">容器管理</h4><p>查看正在运行的容器：<code>docker ps</code><br>查看所有容器：<code>docker ps -a</code><br>删除容器：<code>docker rm [name/id]</code><br>删除所有容器：<code>docker rm ‘docker ps -a -q’</code><br>停止、启动、杀死一个容器：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$docker</span> stop [Name/ID]</span><br><span class="line"><span class="variable">$docker</span> start [Name/ID]</span><br><span class="line"><span class="variable">$docker</span> <span class="built_in">kill</span> [Name/ID]</span><br></pre></td></tr></table></figure></p>
<p>从容器中读取日志：<code>docker logs [Name/ID]</code><br>列出更改项：<code>docker diff [Name/ID]</code><br>从容器中拷贝文件至本机：<code>docker cp ID:/container_path to_path</code><br>附加到一个运行的容器上：<code>docker attach [ID]</code></p>
<h2 id="容器的简单构建">容器的简单构建</h2><p>通过命令操作来部署容器显然很麻烦，所以通过Dockerfile进行自动化容器构建是非常方便的。<br>这里我自己写了一个简单的Dockerfile来练练手，这是一个用于构建Hexo博客的Dockerfile：<br><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#构建的镜像基础</span></span><br><span class="line"><span class="built_in">FROM</span> node:slim</span><br><span class="line"><span class="comment">#维护者</span></span><br><span class="line"><span class="built_in">MAINTAINER</span> sczyh30 root@sczyh30.com</span><br><span class="line"><span class="comment">#执行命令用RUN，注意要遇到需要交互的地方加-y</span></span><br><span class="line"><span class="built_in">RUN</span> <span class="bash">apt-get update \</span><br><span class="line">    &amp;&amp; apt-get install -y git ssh-client ca-certificates --no-install-recommends \</span><br><span class="line">    &amp;&amp; rm -r /var/lib/apt/lists/*</span><br><span class="line"></span><span class="comment">#更改时区</span></span><br><span class="line"><span class="built_in">RUN</span> <span class="bash"><span class="built_in">echo</span> <span class="string">"Asia/Shanghai"</span> &gt; /etc/timezone \</span><br><span class="line">    &amp;&amp; dpkg-reconfigure <span class="operator">-f</span> noninteractive tzdata</span><br><span class="line"></span><span class="comment">#安装hexo</span></span><br><span class="line"><span class="built_in">RUN</span> <span class="bash">npm install hexo-cli -g</span><br><span class="line"></span><span class="comment">#初始化</span></span><br><span class="line"><span class="built_in">RUN</span> <span class="bash"><span class="built_in">cd</span> / &amp;&amp; hexo init blog &amp;&amp; <span class="built_in">cd</span> blog &amp;&amp; npm install</span><br><span class="line"></span><span class="comment">#设定默认工作目录</span></span><br><span class="line"><span class="built_in">WORKDIR</span> <span class="bash">/blog</span><br><span class="line"></span><span class="comment">#设定暴露端口</span></span><br><span class="line"><span class="built_in">EXPOSE</span> <span class="number">4000</span></span><br><span class="line"><span class="comment">#设定容器运行时执行的命令，只能有一条，若多条则执行最后一条</span></span><br><span class="line">CMD hexo s</span><br></pre></td></tr></table></figure></p>
<p>然后在此目录执行构建：<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t sczyh30/simple_<span class="built_in">test</span>:v1 .</span><br></pre></td></tr></table></figure></p>
<p>.表示在当前目录构建<br>docker build的一些参数：<br><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-<span class="ruby">-no-cache=<span class="keyword">false</span> <span class="constant">Do</span> <span class="keyword">not</span> use cache <span class="keyword">when</span> building the image</span><br><span class="line"></span>     -<span class="ruby">q, --quiet=<span class="keyword">false</span> <span class="constant">Suppress</span> the verbose output generated by the containers</span><br><span class="line"></span>     -<span class="ruby">-rm=<span class="keyword">true</span> <span class="constant">Remove</span> intermediate containers after a successful build</span><br><span class="line"></span>     -<span class="ruby">t, --tag=<span class="string">""</span> <span class="constant">Repository</span> name (<span class="keyword">and</span> optionally a tag) to be applied to the resulting image <span class="keyword">in</span> <span class="keyword">case</span> of success</span></span><br></pre></td></tr></table></figure></p>
<p>执行后就会按照Dockerfile的内容进行构建，过几分钟构建成功，用docker run运行一下:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run <span class="operator">-d</span> -p <span class="number">80</span>:<span class="number">4000</span> sczyh30/simple_<span class="built_in">test</span>:v1</span><br></pre></td></tr></table></figure></p>
<p>运行成功~在docker ps里可以看到容器已成功运行：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CONTAINER ID        IMAGE               COMMAND                 CREATED             STATUS              PORTS                  NAMES</span><br><span class="line"><span class="number">45782259f</span>2c3        sczyh30/<span class="keyword">simple_t</span>est:v1     <span class="string">"/bin/sh -c 'hexo s'"</span>   <span class="number">2</span> minutes ago        Up <span class="number">2</span> minutes         <span class="number">0.0</span>.0.0:<span class="number">80</span>-&gt;<span class="number">4000</span>/tcp   trusting_ramanujan</span><br></pre></td></tr></table></figure></p>
<p>在浏览器中打开，一个简单的Hexo已经搭好咯~<br>总结一下，Dockerfile非常方便，以后用它构建容器进行集群部署貌似是不错的选择呢~<br>后面将进行更多的关于Docker的实践。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Architecture/">Architecture</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/架构/">架构</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/虚拟化/">虚拟化</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-game-dev-ue4ce3" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/posts/Develop/game-dev-ue4ce3/" class="article-date">
      <time datetime="2015-03-17T16:12:36.000Z" itemprop="datePublished">2015-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/Develop/game-dev-ue4ce3/">UE4/CE3游戏开发总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>记录我在2015.1 - 2015.3用Unreal Engine 4和CryEngine 3的简单体验~（仅为体验，不涉及具体开发）</p>
<h2 id=""><img src="http://7xkkgd.com1.z0.glb.clouddn.com/ce3pclogo.jpg" alt=""></h2><h2 id="Prolouge">Prolouge</h2><p>UE4和CE3是游戏界中两大游戏引擎元老呀~两个游戏引擎都非常强大，广泛用于大型游戏的开发（像寒霜3、RAGE之类的引擎也是非常牛，但无奈只供内部使用，我们木有办法去体验开发的过程。。）这次寒假便体验了一下这两大引擎开发的魅力~而且3月份虚幻4引擎宣布开源，这真是喜大普奔呀！想研究游戏引擎的话可以看UE4的源代码了话说UE4的代码写的非常规范，不像传说中的CE3的代码风格凌乱（虽然性能比UE4好，代码风格这取决于公司的风格吧）<br>先来UE4吧~</p>
<h2 id="UE4使用体验">UE4使用体验</h2><p>UE4相比Unity而言真是复杂太多了，从各种组件和编辑器上就能看出。Unity还要自己写大气散射，UE4的组件里直接就有，而且可以根据需求自定义，真方便~不过每一次改动Map都要重新烘焙一次光照，组件多了会很慢。。<br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ue4-06.jpg" alt="部分组件"><br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ue4-10.jpg" alt="编辑器界面"><br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ue4-07.jpg" alt="一个虚拟现实的Demo"><br>体验了一番材质编辑器（Material Designer），非常高级（不是美工不会玩），而且翻译很有问题（Normal本该翻译成法线结果翻译成正常，然后我就愉快的把正常的贴图贴到了法线贴图通道上，然后。。。就没有然后了。。调成英文才发现不对劲。。。官方也玩机翻呀。。）<br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ue4-03.jpg" alt="这是自己搓的一个材质"><br>下面是系统自带的一个材质的一部分配置，注意是一个材质！！碉堡了。<br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ue4-08.jpg" alt="系统自带的一个材质 - 冰山一角"><br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ue4-04.jpg" alt="系统自带材质 - 冰山一角"><br>UE4提供了可视化编程脚本Blueprint（蓝图），可以很方便的通过拖拽来完成一些功能，甚至可以用Blueprint完成整个游戏的开发，不需要写代码。（感觉很适合美工诶。。掌握触发器相关蓝图，做个虚拟现实Demo不成问题）至于编程，UE4终于抛弃了UnrealScript，投向了C++的怀抱(C++大法好！)<br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ue4-02.jpg" alt="爆炸效果模拟蓝图"><br>贴图精度高了，不加法线贴图，立体感也很强：<br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ue4-05.jpg" alt="对比图"><br>UE4特别适合做虚拟现实，如果美工给力，场景很真实，再自己搓个AI系统，做出一小个真实世界也是很有可能的~<br>这是一个虚拟现实的实例：<br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-UE4Editor%202015-03-08%2020-15-01-24.png" alt="超级虚拟现实"><br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-UE4Editor%202015-03-08%2020-16-24-68.png" alt="超级虚拟现实"><br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-UE4Editor%202015-03-08%2020-16-34-74.png" alt="超级虚拟现实"><br>总之，UE4的各种特效做的特别好，再配上高精度的材质，智能的脚本，好的创意，细致的优化，定能用UE4做出一款好游戏。而且UE4开源，可以根据自己的需要定制引擎，这一点是CE3无法比拟的。（除非有钱，花几百万买下CE3源码，有这钱还不如自己研发一套呢。。）<br>由于接下来Web方面有任务，UE4的学习就告一段落咯~以后有机会做个虚拟现实系统还是很好的~</p>
<h2 id="CE3使用体验">CE3使用体验</h2><p>CE3的Editor就更强大了，各种特效、脚本设置满天飞，连一个昼夜循环的系统都做得非常心细，不得不说CE3在各方面非常强大。由于这玩意对电脑要求太高，怕把显卡烧了，因此最后就搓了搓demo，玩了玩系统自带的sample，体验了一把以后老老实实继续用UE4和U3D了（逃<br>CE3的资料甚少，学起来还是有些费事的，只好自己乱捣鼓着玩。<br>对于CE3的编程，貌似是Flowgraph(FG,类似于虚幻4的Blueprint)，扩展可以用C++、C#和lua，具体的不太了解。。<br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ce3-01.png" alt="超级CE3"><br>研究Sample的时候，被它的各种控制组件惊呆了，各种分工明确，非常便于开发（没敢改组件，怕改坏了）<br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ce3-02.png" alt="一个完整sample的各种控制"><br><img src="http://7xlgao.com1.z0.glb.clouddn.com/gamedev-ce3-03.png" alt="水面效果"><br>总之，CE3非常强大，但难度系数也很高，对硬件要求也很高。做大型游戏可以用，要不然授权费太高受不了。。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Develop/">Develop</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CE3/">CE3</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Engine/">Engine</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Game/">Game</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UE4/">UE4</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-game-dev-unity" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/posts/Develop/game-dev-unity/" class="article-date">
      <time datetime="2015-03-16T15:44:39.000Z" itemprop="datePublished">2015-03-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/Develop/game-dev-unity/">Unity游戏开发总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>记录我在2014.11 - 2015.2用Unity开发独立游戏的体验~<br><img src="http://7xkkgd.com1.z0.glb.clouddn.com/unity-tt-sc-sc1.jpg" alt="独立游戏Scene 1测试渲染（Blooming强光测试 without SSAO）"></p>
<h2 id=""><img src="http://img.ptcms.csdn.net/article/201503/04/54f65d71078d4_middle.jpg" alt=""></h2><h2 id="Prolouge">Prolouge</h2><p>这是一开始玩Unity的时候做的画面→_→现在看起来一分钟就可以堆出来。。然而当时处于探索的初级阶段，捣鼓了不少时间才捣鼓出来。。。<br><img src="http://7xkkgd.com1.z0.glb.clouddn.com/Unityold%202014-11-24%2015-05-52-61.png" alt="2014.11.24 开发截图"><br><img src="http://7xkkgd.com1.z0.glb.clouddn.com/Unityold%202014-11-25%2018-21-33-49.jpg" alt="2014.11.25 开发截图"><br>当时的艰辛呀！调个特效都调半天。。</p>
<h2 id="Good_Job">Good Job</h2><p>自己的独立游戏一共9个场景（有的场景未完成），美工素材大部分都来源于网络（美工渣没办法。。），渲染和游戏脚本为自创，开发用的Unity4.5.5f1<br>先放一张最原汁原味的Scene 1的图吧~（地图还没来得及起名→_→我想要文艺的名字）<br><img src="http://7xkkgd.com1.z0.glb.clouddn.com/unity4-xxj-scene1-01.jpg" alt="XXJ-Scene 1-UltraRendering"><br>Scene 2 - Desert<br><img src="http://7xkkgd.com1.z0.glb.clouddn.com/u3d-dev-s201.jpg" alt="XXJ-Scene 2-UltraRendering-Dev"><br>待更新~</p>
<h2 id="后记">后记</h2><p>今年3月份Unity 5也轰轰烈烈地发布了。说实话，Unity 5的特效方面改进非常大，特别是光照！然而Unity 5 Project结构貌似也有不小的变动（特别是用自带的Standard Assets，迁移版本都失败了，Shader和脚本的变化应该很大）<br><img src="http://7xkkgd.com1.z0.glb.clouddn.com/unity5-t1-20150731122353.jpg" alt="最近体验Unity 5随手搓的Scene"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Develop/">Develop</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Game/">Game</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unity/">Unity</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开发/">开发</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-database-sql-01" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/posts/Summary/database-sql-01/" class="article-date">
      <time datetime="2015-01-09T08:19:48.000Z" itemprop="datePublished">2015-01-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/Summary/database-sql-01/">数据库知识总结（一） - 基本SQL</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>这一篇主要先对基础SQL语句做些总结~想要写好SQL必须有坚实的基础<br>里面会穿插些性能优化的思想。</p>
<hr>
<p><strong>DDL</strong>(Data Definition Language) 数据库模式定义语言<br>用于操作对象和对象的属性，这种对象包括数据库本身，以及数据库对象，像：表、视图等等<br>主要有：<code>CREATE</code>,<code>DROP</code>,<code>ALTER</code><br>DDL不会对具体的数据进行操作，一般都是对整个表进行操作</p>
<p><strong>DML</strong>(Data Manipulation Language) 数据操控语言<br>用于操作数据库对象中包含的数据，也就是说操作的单位是记录<br>主要有：<code>INSERT</code>,<code>UPDATE</code>,<code>DELETE</code></p>
<p><strong>DCL</strong>(Data Control Language) 数据控制语句<br>DCL的操作是数据库对象的权限，这些操作的确定使数据更加的安全<br>主要有：<code>GRANT</code>,<code>REVOKE</code></p>
<hr>
<h2 id="INSERT语句">INSERT语句</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name (column1,column2,column3,...)</span><br><span class="line"><span class="keyword">VALUES</span> (value1,value2,value3,...);</span></span><br></pre></td></tr></table></figure>
<p>全插入时column可以省略</p>
<h2 id="UPDATE语句">UPDATE语句</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">UPDATE</span> u5er</span><br><span class="line"><span class="keyword">SET</span> id=<span class="number">154196496</span>,<span class="keyword">user</span>=<span class="string">"16516xas6"</span>,<span class="keyword">password</span>=<span class="string">"245sdx"</span>,role=<span class="string">"sdasdcx"</span></span><br><span class="line"><span class="keyword">WHERE</span> id =<span class="number">141</span>;</span></span><br></pre></td></tr></table></figure>
<p> 注意：一定不能漏掉WHERE，否则就全部更改了！</p>
<h2 id="删除语句">删除语句</h2><p>删除表内的一些数据用<strong>DELETE FROM</strong>:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> u5er <span class="keyword">WHERE</span> id=<span class="number">154196496</span>;</span></span><br></pre></td></tr></table></figure></p>
<p>删除整表，可用<strong>DELETE</strong>、<strong>TRUNCATE TABLE</strong>（只删除数据不删除表的本身）、<strong>DROP TABLE</strong><br>比如：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> temp_tb_1;</span></span><br><span class="line"><span class="operator"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> temp_tb_2;</span></span><br><span class="line"><span class="operator"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> temp_tb_3;</span></span><br></pre></td></tr></table></figure></p>
<p>注意：<strong>TRUNCATE TABLE</strong>无法回滚（ROLLBACK命令无效）<br><strong>TRUNCATE TABLE删除速度比DELETE快</strong><br>对Oracle数据库TRUNCATE貌似还会重置水位线（<strong>此处流坑</strong>）</p>
<h2 id="ALTER_TABLE">ALTER TABLE</h2><p>主要语法：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> fuckers</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> thisP <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (id1,id2)</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> SoogYear <span class="keyword">year</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">COLUMN</span> SoogYear</span></span><br></pre></td></tr></table></figure></p>
<h2 id="数据库分页">数据库分页</h2><p>MySQL：使用<strong>LIMIT</strong>语句<br>第一个参数是指要开始的地方，第二个参数是指每页显示多少条数据。第一页用0表示。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">SELECT</span> column_name <span class="keyword">FROM</span> table_name <span class="keyword">LIMIT</span> fr0m,<span class="built_in">number</span>;</span></span><br></pre></td></tr></table></figure></p>
<p>ORACLE：控制ROWNUM<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> column_name  <span class="keyword">WHERE</span> ROWNUM &lt;= <span class="built_in">number</span>;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="模糊查询">模糊查询</h2><p>还是实例描述吧<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> fuckers <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">'%fuck%'</span>;</span>  #百分号通配一个或多个</span><br><span class="line"><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> lang_list <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">'_cala'</span>;</span> #下划线通配一个</span><br><span class="line"><span class="operator"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> fuckers <span class="keyword">WHERE</span> name <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">'[^a-d]%'</span>;</span>  #和正则很像了</span><br></pre></td></tr></table></figure></p>
<p>一般的数据库都支持匹配正则表达式。<br><strong>注意</strong>：模糊查询不能利用索引，会执行全表搜索（可用EXPLAIN语句解析查看详情），因此I/O需求大，性能会受影响。在做性能优化时常建立<strong>全文搜索</strong>（比如Lucene+Nutch）。</p>
<h2 id="别名">别名</h2><p>用<strong>AS</strong>就可以，比如<code>SELECT user AS fucker FROM table</code></p>
<h2 id="SQL_JOIN">SQL JOIN</h2><p>各种连接啊啊啊。。。<br>SQL JOIN 子句用于把来自两个或多个表的行结合起来，基于这些表之间的共同字段。</p>
<h3 id="内连接">内连接</h3><p>INNER JOIN：如果表中有至少一个匹配，则返回行（与JOIN等同）<br><img src="http://www.runoob.com/wp-content/uploads/2013/09/img_innerjoin.gif" alt="内连接集合关系"><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">SELECT</span> akka.id,akka.<span class="keyword">user</span>,stu_info.name,stu_info.email <span class="keyword">FROM</span> akka</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> stu_info</span><br><span class="line"><span class="keyword">ON</span> akka.id=stu_info.id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> akka.id;</span></span><br></pre></td></tr></table></figure></p>
<p>两表是通过<strong>id</strong>字段连接的</p>
<h3 id="外连接">外连接</h3><p>LEFT JOIN：即使右表中没有匹配，也从左表返回所有的行<br>左向外联接的结果集包括  LEFT OUTER子句中指定的左表的所有行和对应联接列所匹配的行。如果左表的某行在右表中没有匹配行，则在相关联的结果集行中右表的所有选择列表列均为空值。<br><img src="http://www.runoob.com/wp-content/uploads/2013/09/img_leftjoin.gif" alt="左连接集合关系"><br>RIGHT JOIN：即使左表中没有匹配，也从右表返回所有的行。思想同左连接。<br><img src="http://www.runoob.com/wp-content/uploads/2013/09/img_rightjoin.gif" alt="右连接集合关系"><br>FULL JOIN：只要其中一个表中存在匹配，则返回行<br><img src="http://www.runoob.com/wp-content/uploads/2013/09/img_fulljoin.gif" alt="完全连接集合关系"><br><strong>注意：外连接都需要注意WHERE 子句的位置。</strong></p>
<h3 id="交叉连接">交叉连接</h3><p>CROSS JOIN：交叉连接，即集合中的笛卡尔积。将两个表的所有行进行组合，连接后的行数为两个表的乘积数。（<strong>存疑：不知道有啥用</strong>）<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">SELECT</span> akka.id,akka.<span class="keyword">user</span>,stu_info.name,stu_info.email <span class="keyword">FROM</span> akka</span><br><span class="line"><span class="keyword">CROSS</span> <span class="keyword">JOIN</span> stu_info</span></span><br></pre></td></tr></table></figure></p>
<p><strong>总结</strong>：连接查询是SQL查询的核心，连接查询的连接类型选择依据实际需求。如果选择不当，非但不能提高查询效率，反而会带来一些逻辑错误。下面总结一下两表连接查询选择方式的依据：<br>1、 查两表关联列相等的数据用内连接。<br>2、 Col_Left是Col_Right的子集时用右外连接。<br>3、 Col_Right是Col_Left的子集时用左外连接。<br>4、 Col_Right和Col_Left彼此有交集但彼此互不为子集时候用全外连接。<br>5、 求差操作的时候用联合查询。</p>
<h2 id="联合查询">联合查询</h2><p>UNION SELECT用于合并查询结果集，比如我要统计一个学校的所有人来自哪里，那么我需要查询每个班的人来自哪里，然后并起来。写成SQL语句就是：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">SELECT</span> location <span class="keyword">from</span> class_1 <span class="keyword">UNION</span> <span class="keyword">SELECT</span> location <span class="keyword">from</span> class_2 <span class="keyword">UNION</span>....</span></span><br></pre></td></tr></table></figure></p>
<p>UNION ALL SELECT可以查询重复的项</p>
<h2 id="SQL_字段属性">SQL 字段属性</h2><p>在MySQL中主要有：</p>
<ul>
<li>NOT NULL - 指示某列不能存储 NULL 值。</li>
<li>AUTO_INCREMENT - 自动生成ID，相当于Oracle中的<strong>sequence</strong>（<strong>这个貌似在读写锁上还有更深入的地方，留坑</strong>）</li>
<li>UNIQUE - 保证某列的每行必须有唯一的值。</li>
<li>PRIMARY KEY - 主键，NOT NULL 和 UNIQUE 的结合。确保某列（或两个列多个列的结合）有唯一标识，有助于更容易更快速地找到表中的一个特定的记录。</li>
<li>FOREIGN KEY - 外键，保证一个表中的数据匹配另一个表中的值的参照完整性。（在关系映射中常用）</li>
<li>CHECK - 保证列中的值符合指定的条件（目前为止MySQL还不支持CHECK约束，解析后会忽略掉。MySQL可以用Trigger实现类似业务逻辑）</li>
<li>DEFAULT - 规定没有给列赋值时的默认值。</li>
</ul>
<p>建个表总结下语法:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">    id <span class="built_in">int</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    username <span class="built_in">varchar</span>(<span class="number">45</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    company <span class="built_in">text</span>(<span class="number">20</span>) <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> <span class="keyword">REFERENCES</span> companyStat(company_name)</span><br><span class="line">    email <span class="built_in">varchar</span>(<span class="number">45</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="keyword">CREATE</span> <span class="keyword">INDEX</span> emailIndex <span class="keyword">ON</span> users(email),</span><br><span class="line">    <span class="keyword">CONSTRAINT</span> mutiID <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (id)</span><br><span class="line">)</span></span><br></pre></td></tr></table></figure></p>
<p>注意级联更新，级联删除</p>
<h2 id="WHERE_和_HAVING">WHERE 和 HAVING</h2><p>where 子句的作用是在对查询结果进行分组前，将不符合where条件的行去掉，即在分组之前过滤数据，where条件中不能包含聚合函数，使用where条件过滤出特定的行。<br>having 子句的作用是筛选满足条件的组，即在分组之后过滤数据，条件中经常包含聚合函数，使用having 条件过滤出特定的组，也可以使用多个分组标准进行分组。</p>
<h2 id="GROUP_BY_和_聚合函数">GROUP BY 和 聚合函数</h2><p>GROUP BY用于根据一个或多个列的结果集分组，常和聚合函数搭配使用。<br>GROUP BY子句限制结果集中的行；对于分组列中的每个非重复值只有一行。<br>要筛选结果 可以先使用WHERE再用GROUP BY 或者先用GROUP BY再用HAVING。<br>比如对学生表里的学生年龄做个统计，统计各年龄的人数:</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Java</td>
<td>20</td>
</tr>
<tr>
<td>2</td>
<td>Scala</td>
<td>16</td>
</tr>
<tr>
<td>3</td>
<td>Erlang</td>
<td>18</td>
</tr>
<tr>
<td>4</td>
<td>Golang</td>
<td>18</td>
</tr>
<tr>
<td>5</td>
<td>Clojure</td>
<td>17</td>
</tr>
<tr>
<td>6</td>
<td>Common Lisp</td>
<td>20</td>
</tr>
<tr>
<td>7</td>
<td>Fuck</td>
<td>16</td>
</tr>
<tr>
<td>8</td>
<td>Haskell</td>
<td>19</td>
</tr>
</tbody>
</table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">SELECT</span> age,<span class="keyword">COUNT</span>(age) <span class="keyword">AS</span> num <span class="keyword">FROM</span> student <span class="keyword">GROUP</span> <span class="keyword">BY</span> age;</span></span><br></pre></td></tr></table></figure>
<p>则结果应当为</p>
<table>
<thead>
<tr>
<th>age</th>
<th>num</th>
</tr>
</thead>
<tbody>
<tr>
<td>16</td>
<td>2</td>
</tr>
<tr>
<td>17</td>
<td>1</td>
</tr>
<tr>
<td>18</td>
<td>2</td>
</tr>
<tr>
<td>19</td>
<td>1</td>
</tr>
<tr>
<td>20</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>注意GROUP BY查询的性能优化。（<strong>待补充</strong>）<br>聚合函数常用的有：<code>AVG()</code>, <code>COUNT()</code>, <code>SUM()</code>, <code>MIN()</code>, <code>MAX()</code>, <code>FIRST()</code>, <code>LAST()</code>。<br>其它字符串处理函数常用<code>UCASE()</code>, <code>UPCASE()</code>, <code>MID()</code>, <code>LEN()</code>, <code>ROUND()</code>等等的。</p>
<p>这些是最基本的SQL语法，后边还将总结更为复杂的SQL语句及其优化。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Summary/">Summary</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Database/">Database</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL/">SQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/数据库/">数据库</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-chemistry-jt-2014" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/posts/Life/chemistry-jt-2014/" class="article-date">
      <time datetime="2014-07-16T10:10:02.000Z" itemprop="datePublished">2014-07-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/Life/chemistry-jt-2014/">2014晶体培养 - 硫酸铜单晶</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>此文章记录14年暑假培养硫酸铜单晶的过程~<br>就是比13年强了那么一丁点而已。。一丁点。。。<br>另外还做了个硫酸铜心形晶簇。。。虽然做的不太好（铜丝好难弯成心形！！！）<br>刚翻了翻相册，发现硫酸铜心形晶簇的图片失传了→_→蛋疼。。<br>翻来倒去只找到一张。。残图。。（晶体已丢失。。）<br><img src="http://7xkkgd.com1.z0.glb.clouddn.com/jt-CuSO4-20140713_174218.jpg" alt="硫酸铜晶体+明矾晶体"><br>可能不小心手抖晃了晃蒸发皿，然后就。。。泛滥了。。。<br>15年再接再厉！力争培养出更优美的晶体！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Life/">Life</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Chemistry/">Chemistry</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
    <article id="post-chemistry-jt-2013" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/posts/Life/chemistry-jt-2013/" class="article-date">
      <time datetime="2013-02-25T08:43:09.000Z" itemprop="datePublished">2013-02-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/posts/Life/chemistry-jt-2013/">2013寒假晶体培养 - 硫酸铜单晶</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>此文章记录2013年寒假培养硫酸铜单晶的经历~<br>第一次培养硫酸铜单晶，由于没有按照实验室标准操作，连蒸发皿都没去买而用了个塑料容器代替的，所以→_→最后没有培养出特别好看的硫酸铜单晶。。<br>做的不好的原因，归结了一下，主要是由于没有密闭培养环境导致结晶时晶体环境不稳定导致的出刺。另外，没有很好地把握住CuSO4的溶解度。。。<br>附成品图一张献丑，比晶体化学吧的大神做的差远了。。。<br><img src="http://7xkkgd.com1.z0.glb.clouddn.com/CuSO4-20130222-A1.jpg" alt="变形记·硫酸铜晶体"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Life/">Life</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Chemistry/">Chemistry</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>








  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/5/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2015 - 2016 sczyh30's blog
            </div>
            <div class="footer-right">
                <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1255963745'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1255963745%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));
                </script>
                Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank">Yelee</a> by MOxFIVE. Enhanced by sczyh30.
            </div>
        </div>
        
    </div>
</footer>
    </div>
    
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>




<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>

<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>


<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>
</body>
</html>